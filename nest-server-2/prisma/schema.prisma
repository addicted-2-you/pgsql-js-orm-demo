generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model chat_members {
  chat_id   String    @db.Uuid
  user_id   String    @db.Uuid
  joined_at DateTime? @default(now()) @db.Timestamp(6)
  chats     chats     @relation(fields: [chat_id], references: [id], onDelete: Cascade)
  users     users     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@id([chat_id, user_id])
}

model chats {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name         String?        @db.VarChar(255)
  created_at   DateTime?      @default(now()) @db.Timestamp(6)
  updated_at   DateTime?      @default(now()) @db.Timestamp(6)
  deleted_at   DateTime?      @db.Timestamp(6)
  chat_members chat_members[]
  messages     messages[]
}

model comments {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  post_id    String    @db.Uuid
  user_id    String    @db.Uuid
  content    String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  deleted_at DateTime? @db.Timestamp(6)
  posts      posts     @relation(fields: [post_id], references: [id], onDelete: Cascade)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model friend_requests {
  id                                        String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  requester_id                              String    @db.Uuid
  receiver_id                               String    @db.Uuid
  status                                    String    @db.VarChar(63)
  created_at                                DateTime? @default(now()) @db.Timestamp(6)
  updated_at                                DateTime? @default(now()) @db.Timestamp(6)
  users_friend_requests_receiver_idTousers  users     @relation("friend_requests_receiver_idTousers", fields: [receiver_id], references: [id], onDelete: Cascade)
  users_friend_requests_requester_idTousers users     @relation("friend_requests_requester_idTousers", fields: [requester_id], references: [id], onDelete: Cascade)

  @@unique([requester_id, receiver_id])
}

model messages {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  chat_id    String    @db.Uuid
  sender_id  String    @db.Uuid
  type       String    @db.VarChar(63)
  content    String    @db.VarChar(1000)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  deleted_at DateTime? @db.Timestamp(6)
  chats      chats     @relation(fields: [chat_id], references: [id], onDelete: Cascade)
  users      users     @relation(fields: [sender_id], references: [id], onDelete: Cascade)
}

model post_views {
  id        String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  post_id   String    @db.Uuid
  user_id   String?   @db.Uuid
  viewed_at DateTime? @default(now()) @db.Timestamp(6)
  posts     posts     @relation(fields: [post_id], references: [id], onDelete: Cascade)
  users     users?    @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model posts {
  id                 String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id            String               @db.Uuid
  title              String               @db.VarChar(255)
  content            String?
  created_at         DateTime?            @default(now()) @db.Timestamp(6)
  updated_at         DateTime?            @default(now()) @db.Timestamp(6)
  deleted_at         DateTime?            @db.Timestamp(6)
  comments           comments[]
  post_views         post_views[]
  users              users                @relation(fields: [user_id], references: [id], onDelete: Cascade)
  reactions_to_posts reactions_to_posts[]
}

model reactions_to_posts {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id    String    @db.Uuid
  post_id    String    @db.Uuid
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  deleted_at DateTime? @db.Timestamp(6)
  posts      posts     @relation(fields: [post_id], references: [id], onDelete: Cascade)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, post_id])
}

model user_avatars {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id    String?   @unique @db.Uuid
  avatar_url String    @db.VarChar(255)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  deleted_at DateTime? @db.Timestamp(6)
  users      users?    @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model user_emails {
  id          String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id     String    @db.Uuid
  email       String    @unique @db.VarChar(255)
  is_verified Boolean?  @default(false)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
  deleted_at  DateTime? @db.Timestamp(6)
  users       users     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "fk_user_email")
}

model user_phones {
  id          String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id     String    @db.Uuid
  phone       String    @unique @db.VarChar(63)
  is_verified Boolean?  @default(false)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
  deleted_at  DateTime? @db.Timestamp(6)
  users       users     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "fk_user_phone")
}

model users {
  id                                                  String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  username                                            String               @db.VarChar(255)
  password                                            String               @db.VarChar(255)
  is_admin                                            Boolean?             @default(false)
  created_at                                          DateTime?            @default(now()) @db.Timestamp(6)
  updated_at                                          DateTime?            @default(now()) @updatedAt @db.Timestamp(6)
  deleted_at                                          DateTime?            @db.Timestamp(6)
  chat_members                                        chat_members[]
  comments                                            comments[]
  follow_requests_follow_requests_followee_idTousers  follow_requests[]    @relation("follow_requests_followee_idTousers")
  follow_requests_follow_requests_follower_idTousers  follow_requests[]    @relation("follow_requests_follower_idTousers")
  friend_requests_friend_requests_receiver_idTousers  friend_requests[]    @relation("friend_requests_receiver_idTousers")
  friend_requests_friend_requests_requester_idTousers friend_requests[]    @relation("friend_requests_requester_idTousers")
  messages                                            messages[]
  post_views                                          post_views[]
  posts                                               posts[]
  reactions_to_posts                                  reactions_to_posts[]
  user_avatars                                        user_avatars?
  user_emails                                         user_emails[]
  user_phones                                         user_phones[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model follow_requests {
  id                                       String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  follower_id                              String    @db.Uuid
  followee_id                              String    @db.Uuid
  status                                   String    @db.VarChar(63)
  created_at                               DateTime? @default(now()) @db.Timestamp(6)
  updated_at                               DateTime? @default(now()) @db.Timestamp(6)
  users_follow_requests_followee_idTousers users     @relation("follow_requests_followee_idTousers", fields: [followee_id], references: [id], onDelete: Cascade)
  users_follow_requests_follower_idTousers users     @relation("follow_requests_follower_idTousers", fields: [follower_id], references: [id], onDelete: Cascade)

  @@unique([follower_id, followee_id])
}
